ranking_4 <- apply(ranking_4,2,function(x)gsub("russian federation","russia",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("new zealand","newzealand",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("south korea","southkorea",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("costa rica","costarica",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("czech republic","czechrepublic",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("north macedonia","macedonia",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("syrian arab republic","syria",x))
ranking_4 <- apply(ranking_4,2,function(x)gsub("brunei darussalam","brunei",x))
ranking_4 <- as_tibble(ranking_4)
str(ranking_4)
ranking_px <- matched_countries %>%
slice(1:117,119:122)
ranking_5 <- ranking_4$value[match(ranking_px$Country,ranking_4$value1)]
ranking_5 <- as_tibble(ranking_5)
ranking_6 <- bind_cols(readyData_for_correlation,ranking_5)
ranking_6
ranking_6 <- ranking_6 %>%
mutate(value= as.double(value))
ranking_6
# Rename value and number
ranking_6 <- ranking_6 %>%
rename("Scimago_rank"="value")
ranking_6 <- ranking_6 %>%
rename("Number_of_publications"="Number")
s <- ggplot(ranking_6,aes(x=Scimago_rank,y=Number_of_publications)) +geom_point() + geom_smooth() + scale_y_log10()
s
View(ranking_6)
ranking_7 <- ranking_6 %>%
select(-c(Population,Population_mln,Articles_perMln,HDI_2018,))
ranking_7
View(readyData_for_correlation)
readyData_for_correlation_covid <- readRDS("D:/Projekt_COVID/readyData_for_correlation_covid.RDS")
View(readyData_for_correlation_covid)
ranking_7 <- ranking_7 %>%
slice(1:20)
ranking_7
save(ranking_7, file ='scimago_ranking.RData')
ranking_8 <- as.data.frame(ranking_7)
ranking_8
library(xlsx)
write.xlsx(ranking_8,file = "scimago_ranking")
write.xlsx(ranking_8,file = "scimago_ranking.xlsx")
?write.xlsx()
write.xlsx(ranking_8,file = "D:/Projekt_COVID/Tabels/scimago_ranking.xlsx")
library(stringr)
ranking_9 <- ranking_8 %>%
mutate(Country= str_to_title(Country))
ranking_9
write.xlsx(ranking_9,file = "D:/Projekt_COVID/Tabels/scimago_ranking.xlsx")
write.xlsx(ranking_9,file = "D:/Projekt_COVID/Tabels/scimago_ranking.xlsx")
sci_journal_16 <- sci_journal_16 %>%
arrange(desc(freq))
# COunt categories
sci_journal_16 <- count(sci_journal_15)
sci_journal_16 <- as_tibble(sci_journal_16)
sci_journal_16
# Save df as tibble
b1 <- as_tibble(raw_data)
# Delete unnecessary columns
c1 <- b1 %>%
select(-abstract, -keywords,-email)
c1
# Distinct journal column from the rest of the tibble
d1 <- distinct(c1,journal)
d1
# Make all letters in lowercase
d1 <- d1  %>%
mutate(journal = tolower(journal))
d1
# Remove all data in parenthesis
q1 <- apply(d1,2,function(x)gsub("\\s*\\([^\\)]+\\)","",x))
# Remove all data after colon
q1 <- apply(q1,2,function(x)gsub(":.*","",x))
# Remove commas
q1 <- apply(q1,2,function(x)gsub(",","",x))
# Remove equal sign
q1 <- apply(q1,2,function(x)gsub("=","",x))
# Change &amp; to and
q1 <- apply(q1,2,function(x)gsub("&amp;", "and", x))
# Remove the from text
q1 <- apply(q1,2,function(x)gsub("the", "", x))
# Remove whitespace
q1 <- apply(q1,2,function(x)gsub('\\s+', '',x))
# Save as tibble
q1 <- as_tibble(q1)
# Remove punctuation from journal column and make tibble again
e1 <- q1$journal %>%
removePunctuation()
e1
e1 <- as_tibble(e1)
e1
# Rename value column to Title
f1 <- e1 %>%
rename("Title"= "value")
f1
# Load Scimago journal database
sci_journal <- read.csv("D:/Projekt_COVID/scimagojr_2019.csv",
header = TRUE, sep = ";",stringsAsFactors = FALSE)
sci_journal <- as_tibble(sci_journal)
sci_journal
# Check structure of the data
glimpse(sci_journal)
### Scimago data preparation ###
### Prepare Scimago database for matching (pull Title column)###
sci_journal_1 <- sci_journal %>%
pull(Title)
sci_journal_1
sci_journal_1 <-as_tibble(sci_journal_1)
# Make all the letters in lowercase
sci_journal_1 <- sci_journal_1 %>%
mutate(value =tolower(value))
# Remove all data after colon
sci_journal_1 <- apply(sci_journal_1,2,function(x)gsub(":.*","",x))
# Remove "the"
sci_journal_1 <- apply(sci_journal_1,2,function(x)gsub("the","",x))
# Remove punctuation from Title column
sci_journal_2 <- sci_journal_1 %>%
removePunctuation()
sci_journal_2 <- as_tibble(sci_journal_2)
sci_journal_2
# Rename column to Title
sci_journal_3 <- sci_journal_2 %>%
rename("Title"= "value")
sci_journal_3
# Remove whitespace in Title column
sci_journal_4 <- apply(sci_journal_3,2,function(x)gsub('\\s+', '',x))
sci_journal_4 <- as_tibble(sci_journal_4)
sci_journal_4
# Pull Categories data column from
sci_journal_10 <- sci_journal %>%
pull(Categories)
sci_journal_10 <- as_tibble(sci_journal_10)
sci_journal_10
# Prepare data
sci_journal_11 <- apply(sci_journal_10,2,function(x)gsub(';.*', '',x))
sci_journal_11 <- apply(sci_journal_11,2,function(x)gsub("\\s*\\([^\\)]+\\)","",x))
sci_journal_11 <- as_tibble(sci_journal_11)
# Rename value to Categories
sci_journal_12 <- sci_journal_11 %>%
rename("Categories"= "value")
sci_journal_12
# Bind two tibbles (Title and Categories)
sci_journal_13 <- bind_cols(sci_journal_4,sci_journal_12)
sci_journal_13
View(sci_journal_13)
# Match data
sci_journal_14 <- sci_journal_13$Categories[match(f1$Title,sci_journal_13$Title)]
sci_journal_14
sci_journal_14 <- as_tibble(sci_journal_14)
sci_journal_14
# Drop missing rows
sci_journal_15 <- sci_journal_14 %>%
drop_na()
sci_journal_15
library(plyr)
# COunt categories
sci_journal_16 <- count(sci_journal_15)
sci_journal_16 <- as_tibble(sci_journal_16)
sci_journal_16
sci_journal_16 <- sci_journal_16 %>%
arrange(desc(freq))
print(sci_journal_16, n=124)
#SLice 20 from the top
sci_journal_17 <- sci_journal_16 %>%
slice(1:20)
sci_journal_17
# Remove all data in parenthesis
q1 <- apply(d1,2,function(x)gsub("\\s*\\([^\\)]+\\)","",x))
###sample script - Publications matching####
library(tidyverse)
library(easyPubMed)
library(tm)
# Remove all data in parenthesis
q1 <- apply(d1,2,function(x)gsub("\\s*\\([^\\)]+\\)","",x))
# Remove all data after colon
q1 <- apply(q1,2,function(x)gsub(":.*","",x))
# Remove commas
q1 <- apply(q1,2,function(x)gsub(",","",x))
# Remove equal sign
q1 <- apply(q1,2,function(x)gsub("=","",x))
# Change &amp; to and
q1 <- apply(q1,2,function(x)gsub("&amp;", "and", x))
# Remove the from text
q1 <- apply(q1,2,function(x)gsub("the", "", x))
# Remove whitespace
q1 <- apply(q1,2,function(x)gsub('\\s+', '',x))
q1 <- apply(q1,2,function(x)gsub(' +',' ',x))
# Save as tibble
q1 <- as_tibble(q1)
# Remove punctuation from journal column and make tibble again
e1 <- q1$journal %>%
removePunctuation()
e1
e1 <- as_tibble(e1)
e1
# Rename value column to Title
f1 <- e1 %>%
rename("Title"= "value")
f1
# Match data
sci_journal_14 <- sci_journal_13$Categories[match(f1$Title,sci_journal_13$Title)]
sci_journal_14
sci_journal_14 <- as_tibble(sci_journal_14)
sci_journal_14
# Drop missing rows
sci_journal_15 <- sci_journal_14 %>%
drop_na()
sci_journal_15
View(sci_journal_17)
library(plyr)
# Rename columns
sci_journal_18 <- sci_journal_17 %>%
rename("Categories"= "value")
sci_journal_18 <- sci_journal_18 %>%
rename("Number"= "freq")
# Rename columns
sci_journal_18 <- sci_journal_17 %>%
rename("Categories"= "value")
# Rename columns
sci_journal_18 <- sci_journal_17 %>%
rename("Categories"= "value")
###sample script - Publications matching####
library(tidyverse)
# Rename columns
sci_journal_18 <- sci_journal_17 %>%
rename("Categories"= "value")
sci_journal_18 <- sci_journal_18 %>%
rename("Number"= "freq")
sci_journal_18
# Save as excel file
write.xlsx(sci_journal_18,file = "D:/Projekt_COVID/Tabels/categories_scimago.xlsx")
library(xlsx)
# Save as excel file
write.xlsx(sci_journal_18,file = "D:/Projekt_COVID/Tabels/categories_scimago.xlsx")
View(matched_countries)
View(readyData_for_correlation_covid)
View(readyData_for_correlation)
ranking_9
ranking_9 <- as_tibble(ranking_9)
library(tidyverse)
ranking_9 <- as_tibble(ranking_9)
ranking_9
# Save RDS data
saveRDS(ranking_9,"D:/Projekt_COVID/scimago_ranking_readyData")
saveRDS(sci_journal_18,"D:Projekt_COVID/scimago_categories_readyData")
saveRDS(sci_journal_18,"D:Projekt_COVID/scimago_categories_readyData")
# Save as RDS file
saveRDS(sci_journal_18,"D:/Projekt_COVID/scimago_categories_readyData.RDS")
# Save RDS data
saveRDS(ranking_9,"D:/Projekt_COVID/scimago_ranking_readyData.RDS")
View(readyData_for_correlation)
readyData_for_correlation <- readyData_for_correlation %>%
rename("Number of articles"="Number")
readyData_for_correlation
readyData_for_correlation_covid <- readyData_for_correlation_covid %>%
rename("Number of articles"="Number")
readyData_for_correlation_covid
saveRDS(readyData_for_correlation,"D:/Projekt_COVID/readyData_for_correlation.RDS")
saveRDS(readyData_for_correlation_covid,"D:/Projekt_COVID/readyData_for_correlation_covid")
saveRDS(readyData_for_correlation_covid,"D:/Projekt_COVID/readyData_for_correlation_covid.RDS")
scimago_ranking_readyData <- readRDS("D:/Projekt_COVID/scimago_ranking_readyData.RDS")
View(scimago_ranking_readyData)
scimago_categories_readyData <- readRDS("D:/Projekt_COVID/scimago_categories_readyData.RDS")
View(scimago_categories_readyData)
readyData_for_correlation_covid <- readRDS("D:/Projekt_COVID/readyData_for_correlation_covid.RDS")
View(readyData_for_correlation_covid)
readyData_for_correlation <- readRDS("D:/Projekt_COVID/readyData_for_correlation.RDS")
View(readyData_for_correlation)
View(matched_countries)
###sample script - country analysis####
library(tidyverse)
# Load downloaded data
mypath = "D:/Projekt_COVID/COVID_Data"
setwd(mypath)
# Create list of text files
txt_files_ls = list.files(path=mypath, pattern="*.txt")
# Save df as tibble
b <- as_tibble(raw_data)
# Delete unnecessary columns
c <- b %>%
select(-abstract, -keywords,-email)
c
# Pull address column from the rest of the tibble
d <- c %>%
pull(address)
d
s <- gsub("United Kingdom","UK",d)
s <- gsub("United States","USA",s)
s <- gsub("South Korea","Southkorea",s)
s <- gsub("Saudi Arabia","Saudiarabia",s)
s <- gsub("New Zealand","Newzealand",s)
s <- gsub("the Netherlands","Netherlands",s)
s <- gsub("South Africa","Southafrica",s)
s <- gsub("Czech Republic", "Czechrepublic",s)
s <- gsub("Costa Rica", "Costarica",s)
s <- gsub("Jersey", "USA",s)
s
# Remove punctuation
e <- gsub("[[:punct:]\n]","",s)
e
# Split data at word boundaries
f <- strsplit(e, " ")
f
library(maps)
library(parallel)
# Load world.cities data
data("world.cities")
# Pull country.etc from world.cities
r <- world.cities %>%
pull(country.etc)
# Change names of some countries
r <- gsub("Korea South","Southkorea",r)
r <- gsub("Saudi Arabia","Saudiarabia",r)
r <- gsub("New Zealand","Newzealand",r)
r <- gsub("South Africa","Southafrica",r)
r <- gsub("Czech Republic", "Czechrepublic",r)
r <- gsub("Costa Rica", "Costarica",r)
r <- gsub("Jersey", "USA",r)
r <- as_tibble(r)
r                              ### Matching countries ###
# Detect number of cores
detectCores()
# Make cluster
cluster_1 <- makeCluster(3)
# Export needed data to every cluster
clusterExport(cluster_1,"r")
# Apply function
l <- clusterApply(cluster_1,f,function(x)x[which(toupper(x) %in% toupper(r$value))])
# Stop cluster
stopCluster(cluster_1)
## Tidy outcome data
l <- do.call(rbind, lapply(l, as.data.frame))
# Check data structure
str(l)
l
# Change factor to character variable
o <- data.frame(lapply(l, as.character), stringsAsFactors=FALSE)
# Count countries
o <- o %>%
mutate(X..i..=tolower(X..i..))
m <- count(o)
m
library(plyr)
# Count countries
o <- o %>%
mutate(X..i..=tolower(X..i..))
m <- count(o)
m
View(m)
library(tidyverse)
ranking_7 <- ranking_6 %>%
select(-c(Population,Population_mln,Articles_perMln,HDI_2018,))
ranking_7
View(ranking_7)
ranking_7 <- ranking_7 %>%
mutate(Country= str_to_title(Country))
ranking_7
saveRDS(ranking_7,"D:/Projekt_COVID/scimago_ranking_full.RDS")
scimago_ranking_full <- readRDS("D:/Projekt_COVID/scimago_ranking_full.RDS")
View(scimago_ranking_full)
sci_journal_13
View(sci_journal_13)
sci_journal_12
# Prepare data
sci_journal_11 <- apply(sci_journal_10,2,function(x)gsub(';.*', '',x))
sci_journal_11 <- as_tibble(sci_journal_11)
View(sci_journal_11)
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', '',x))
sci_journal_10q <- sci_journal %>%
pull(Categories)
sci_journal_10q <- as_tibble(sci_journal_10q)
sci_journal_10q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', '',x))
sci_journal_11q <- as_tibble(sci_journal_11q)
View(sci_journal_11q)
sci_journal_11q
sci_journal_12q <- trimws(gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", sci_journal_11q, perl = TRUE))
sci_journal_12q <- as_tibble(sci_journal_12q)
View(sci_journal_12q)
sci_journal_12q <-apply(trimws(gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", sci_journal_11q, perl = TRUE)))
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_12q <-apply(sci_journal_11q,2,function(x)trimws(gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", sci_journal_11q, perl = TRUE)),x)
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)|.", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
library(stringr)
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
paste(str_extract_all(sci_journal_11q, "\\([^)]*\\)")[[1]], collapse=' ')
cv <- paste(str_extract_all(sci_journal_11q, "\\([^)]*\\)")[[1]], collapse=' ')
cv_1 <- as_tibble(cv)
View(cv_1)
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\([^)]*\\)", "",x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", perl = TRUE),x))
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", perl = TRUE),x)
sci_journal_11q <- apply(sci_journal_10q,2,function(x)gsub(';.*', "",x))
sci_journal_11q <- apply(sci_journal_11q,2,function(x)gsub("\\s+\\([^)]*\\)(*SKIP)(*FAIL)|.", "", perl = TRUE,x))
sci_journal_11q <- as_tibble(sci_journal_11q)
sci_journal_11q
View(sci_journal_11)
View(sci_journal_11q)
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(miscellaneous)', "",x))
sci_journal_12q <- as_tibble(sci_journal_12q)
sci_journal_12q
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("\\s*\\([^\\)]+\\)","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("\\D","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
View(sci_journal_13q)
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("[A-Za-z(), ]","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
sci_journal_12q
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("[A-Za-z(), ]","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("[()]","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
# Remove whitespace
sci_journal_13q <- apply(sci_journal_13q,2,function(x)gsub('\\s+', '',x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
View(sci_journal_13q)
View(sci_journal_12q)
# Remove additional words
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(miscellaneous)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(social science)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(medical)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(clinical', "",x))
# Remove additional words
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(miscellaneous)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(social science)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(medical)', "",x))
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(clinical)', "",x))
sci_journal_12q <- as_tibble(sci_journal_12q)
sci_journal_12q
View(sci_journal_12q)
# Remove additional words
sci_journal_12q <- apply(sci_journal_11q,2,function(x)gsub('(miscellaneous)', "",x))
sci_journal_12q <- apply(sci_journal_12q,2,function(x)gsub('(social science)', "",x))
sci_journal_12q <- apply(sci_journal_12q,2,function(x)gsub('(medical)', "",x))
sci_journal_12q <- apply(sci_journal_12q,2,function(x)gsub('(clinical)', "",x))
sci_journal_12q <- as_tibble(sci_journal_12q)
sci_journal_12q
View(sci_journal_12q)
# Remove parenthesis
sci_journal_13q <- apply(sci_journal_12q,2,function(x)gsub("[()]","",x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
# Remove whitespace
sci_journal_13q <- apply(sci_journal_13q,2,function(x)gsub('\\s+', '',x))
sci_journal_13q <- as_tibble(sci_journal_13q)
sci_journal_13q
View(sci_journal_13q)
View(sci_journal_12q)
View(sci_journal_11q)
View(sci_journal_4)
sci_journal_14q <- bind_cols(sci_journal_4,sci_journal_13q)
sci_journal_14q
View(f1)
sci_journal_15q <- sci_journal_14q$value[match(f1$Title,sci_journal_14q$Title)]
sci_journal_15q <- as_tibble(sci_journal_15q)
sci_journal_15q
View(sci_journal_15q)
# Drop missing rows
sci_journal_15q <- sci_journal_15q %>%
drop_na()
sci_journal_15q
sci_journal_15q
sci_journal_15q
View(sci_journal_15)
View(matched_countries)
View(o)
View(sci_journal_15)
View(sci_journal_15q)
View(f1)
View(ranking_px)
View(sci_journal_14)
View(o)
